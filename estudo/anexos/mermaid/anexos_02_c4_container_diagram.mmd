graph TB
    %% External Users
    ADMIN[ğŸ‘¥ Administrador<br/>Browser]
    DEV[ğŸ‘¥ Desenvolvedor<br/>APIs Clientes]
    
    %% External Systems
    AAD[ğŸ”‘ Azure AD<br/>Identity Provider]
    INSIGHTS[ğŸ“Š Application Insights<br/>Observability]
    TEAMS[ğŸ’¬ Microsoft Teams<br/>Notifications]
    
    subgraph "Sistema de ParametrizaÃ§Ã£o de ConfiguraÃ§Ãµes DinÃ¢micas"
        subgraph "Presentation Layer"
            PORTAL[ğŸŒ Configuration Portal<br/>Angular 16 SPA<br/><br/>Interface administrativa para<br/>gestÃ£o de parÃ¢metros, aprovaÃ§Ãµes<br/>e dashboards de analytics]
            
            WEBAPP[ğŸ“± Web App<br/>Azure Static Web Apps<br/><br/>Hospedagem do portal Angular<br/>com CDN e custom domains]
        end
        
        subgraph "Application Services"
            MGMT[âš™ï¸ Configuration Management API<br/>ASP.NET Core 8 Web API<br/><br/>CRUD de parÃ¢metros, versionamento,<br/>workflow de aprovaÃ§Ã£o e<br/>validaÃ§Ã£o de schemas]
            
            DIST[ğŸ“¡ Configuration Distribution API<br/>ASP.NET Core 8 Web API<br/><br/>DistribuiÃ§Ã£o otimizada de parÃ¢metros<br/>com cache inteligente e<br/>push notifications]
            
            WORKFLOW[ğŸ”„ Workflow Engine<br/>Azure Functions v4<br/><br/>OrquestraÃ§Ã£o de aprovaÃ§Ãµes,<br/>notificaÃ§Ãµes e agendamento<br/>de mudanÃ§as]
            
            AUDIT[ğŸ“‹ Audit Service<br/>Azure Functions v4<br/><br/>Processamento de eventos de<br/>auditoria e geraÃ§Ã£o de<br/>relatÃ³rios compliance]
        end
        
        subgraph "Data Layer"
            COSMOS[(ğŸ—„ï¸ Configuration Database<br/>Azure Cosmos DB<br/><br/>RepositÃ³rio principal com<br/>parÃ¢metros, versÃµes e<br/>change requests)]
            
            REDIS[(âš¡ Cache Layer<br/>Azure Cache for Redis<br/><br/>Cache distribuÃ­do para<br/>performance e reduÃ§Ã£o<br/>de latÃªncia)]
            
            BLOB[(ğŸ“¦ Backup Storage<br/>Azure Blob Storage<br/><br/>Backup de configuraÃ§Ãµes<br/>e arquivos de fallback<br/>durante migraÃ§Ã£o)]
        end
        
        subgraph "Integration Layer"
            EVENTGRID[ğŸ“¨ Event Grid<br/>Azure Event Grid<br/><br/>Event routing para<br/>propagaÃ§Ã£o de mudanÃ§as<br/>e integraÃ§Ã£o assÃ­ncrona]
            
            SIGNALR[ğŸ”” SignalR Service<br/>Azure SignalR Service<br/><br/>Push notifications em<br/>tempo real para clientes<br/>conectados]
            
            SDK[ğŸ“š Configuration SDK<br/>.NET Standard 2.1 Library<br/><br/>Cliente library com cache<br/>local, circuit breaker e<br/>fallback automÃ¡tico]
        end
        
        subgraph "Security & Monitoring"
            KEYVAULT[ğŸ” Key Vault<br/>Azure Key Vault<br/><br/>Gerenciamento de secrets,<br/>connection strings e<br/>certificados]
            
            GATEWAY[ğŸšª API Gateway<br/>Azure API Management<br/><br/>Rate limiting, authentication<br/>proxy e API versioning]
        end
    end
    
    %% User Interactions
    ADMIN -->|HTTPS/Angular<br/>GestÃ£o de parÃ¢metros| PORTAL
    PORTAL -->|HTTPS/REST<br/>CRUD operations| MGMT
    
    DEV -->|HTTPS/REST<br/>Consulta parÃ¢metros| DIST
    DEV -->|NuGet Package<br/>SDK integration| SDK
    
    %% Internal API Communications
    MGMT -->|SQL API<br/>Read/Write| COSMOS
    MGMT -->|Event Publishing<br/>Parameter changes| EVENTGRID
    MGMT -->|Cache Operations<br/>Invalidation| REDIS
    
    DIST -->|SQL API<br/>Read-only| COSMOS
    DIST -->|Cache Operations<br/>Get/Set| REDIS
    DIST -->|Connection Management<br/>Client notifications| SIGNALR
    
    WORKFLOW -->|Event Subscription<br/>Approval workflow| EVENTGRID
    WORKFLOW -->|Notification API<br/>Teams integration| TEAMS
    WORKFLOW -->|SQL API<br/>Update status| COSMOS
    
    AUDIT -->|Event Subscription<br/>Audit events| EVENTGRID
    AUDIT -->|Telemetry API<br/>Audit logs| INSIGHTS
    
    %% SDK Interactions
    SDK -->|HTTPS/REST<br/>Parameter requests| DIST
    SDK -->|WebSocket<br/>Real-time updates| SIGNALR
    SDK -->|HTTPS/REST<br/>Fallback requests| BLOB
    
    %% Event Flow
    EVENTGRID -->|Event Delivery<br/>Parameter changes| SIGNALR
    EVENTGRID -->|Event Delivery<br/>Workflow triggers| WORKFLOW
    EVENTGRID -->|Event Delivery<br/>Audit events| AUDIT
    
    %% Security Integrations
    PORTAL -->|OAuth 2.0<br/>User authentication| AAD
    MGMT -->|OAuth 2.0<br/>API authentication| AAD
    DIST -->|OAuth 2.0<br/>API authentication| AAD
    
    MGMT -->|Secret Management<br/>Connection strings| KEYVAULT
    DIST -->|Secret Management<br/>Connection strings| KEYVAULT
    WORKFLOW -->|Secret Management<br/>API keys| KEYVAULT
    
    %% Gateway Integration
    MGMT -->|API Registration<br/>Rate limiting| GATEWAY
    DIST -->|API Registration<br/>Rate limiting| GATEWAY
    
    %% Monitoring
    MGMT -->|Telemetry<br/>Logs/Metrics| INSIGHTS
    DIST -->|Telemetry<br/>Logs/Metrics| INSIGHTS
    WORKFLOW -->|Telemetry<br/>Function logs| INSIGHTS
    AUDIT -->|Telemetry<br/>Audit metrics| INSIGHTS
    
    %% Styling
    classDef webStyle fill:#42a5f5,stroke:#1976d2,stroke-width:2px,color:#fff
    classDef apiStyle fill:#66bb6a,stroke:#388e3c,stroke-width:2px,color:#fff
    classDef dataStyle fill:#ffa726,stroke:#f57c00,stroke-width:2px,color:#fff
    classDef eventStyle fill:#ab47bc,stroke:#7b1fa2,stroke-width:2px,color:#fff
    classDef securityStyle fill:#ef5350,stroke:#d32f2f,stroke-width:2px,color:#fff
    classDef externalStyle fill:#78909c,stroke:#455a64,stroke-width:2px,color:#fff
    classDef userStyle fill:#43a047,stroke:#1b5e20,stroke-width:2px,color:#fff
    
    class PORTAL,WEBAPP webStyle
    class MGMT,DIST,WORKFLOW,AUDIT apiStyle
    class COSMOS,REDIS,BLOB dataStyle
    class EVENTGRID,SIGNALR,SDK eventStyle
    class KEYVAULT,GATEWAY securityStyle
    class AAD,INSIGHTS,TEAMS externalStyle
    class ADMIN,DEV userStyle
